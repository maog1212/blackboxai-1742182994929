apiVersion: v1
kind: ConfigMap
metadata:
  name: vuln-detection-config
  namespace: vuln-detection
data:
  # 通用配置
  LOG_LEVEL: "info"
  LOG_FORMAT: "json"
  ENVIRONMENT: "production"

  # 服务地址
  SCANNER_URL: "http://scanner:8081"
  DETECTION_URL: "http://detection-engine:8082"
  RESPONSE_URL: "http://response:8083"
  NOTIFICATION_URL: "http://notification:8084"

  # 数据库配置
  DATABASE_URL: "postgresql://vulnuser:vulnpass@postgres:5432/vulndb"
  REDIS_URL: "redis://redis:6379"
  RABBITMQ_URL: "amqp://admin:rabbitmq_password@rabbitmq:5672"

  # Scanner配置
  SCANNER_PORT: "8081"
  SCANNER_SCHEDULE: "0 2 * * *"
  SCAN_THREADS: "4"
  SCAN_TIMEOUT: "3600"

  # Detection Engine配置
  DETECTION_PORT: "8082"
  DETECTION_RULES_PATH: "/app/rules"
  SIGNATURE_UPDATE_INTERVAL: "3600"

  # Response Service配置
  RESPONSE_PORT: "8083"
  AUTO_PATCH_ENABLED: "false"
  PATCH_CONFIRMATION_REQUIRED: "true"
  POC_TEST_ENABLED: "true"

  # Notification Service配置
  NOTIFICATION_PORT: "8084"
  EMAIL_ENABLED: "true"
  SMTP_PORT: "587"

  # API Gateway配置
  API_GATEWAY_PORT: "8080"
  JWT_EXPIRATION_HOURS: "24"
